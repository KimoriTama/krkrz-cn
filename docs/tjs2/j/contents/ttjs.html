<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html  xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh" lang="zh">
<!-- generated by to_html.pl from ttjs.xml -->
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<title>tTJS</title>
	<meta name="author" content="W.Dee" />
	<meta http-equiv="Content-Style-Type" content="text/css" />
	<meta http-equiv="Content-Script-Type" content="text/javascript" />
	<link href="browser.css" type="text/css" rel="stylesheet" title="吉里吉里相关标准参考样式" />
	<link href="mailto:dee@kikyou.info" rev="Made" />
	<link href="index.html" target="_top" rel="Start" title="首页" />
</head>
<body>
<h1><a id="id379" name="id379">tTJS 是什么</a>
</h1><div class="para"><div>
	　TJS2脚本引擎类。您可以通过该类中的对象来处理TJS2。<br />
</div></div>
<h1><a id="id380" name="id380">コンストラクタ</a>
</h1><div class="para"><div>
　tTJS构造函数没有参数。<br />
　不能将tTJS对象创建为自动变量。必须使用new运算符创建。<br />
　刚创建的引用计数器为1。这意味着只要调用Release方法，就可以释放tTJS对象。<br />
</div></div>

<h1><a id="id381" name="id381">析构</a>
</h1><div class="para"><div>
	　tTJS析构函数位于保护部分，无法访问。<br />
	　使用Release方法释放tTJS对象。<br />
	　此外，建议在释放tTJS对象之前调用Shutdown方法。<br />
</div></div>

<h1><a id="id382" name="id382">AddRef</a>
</h1><div class="para"><div>
void tTJS::AddRef()<br />
<br />
　递增TJS2脚本引擎引用计数器。</div></div>
<h1><a id="id383" name="id383">Release</a>
</h1><div class="para"><div>
void tTJS::Release()<br />
<br />
　递减TJS2脚本引擎引用计数器。<br />
　如果引用计数器为0，则释放tTJS对象。</div></div>
<h1><a id="id384" name="id384">Shutdown</a>
</h1><div class="para"><div>
void tTJS::Shutdown()<br />
<br />

　关闭脚本引擎。<br />
<br />
　释放TJS2脚本引擎时，建议在Release方法之前调用此方法。<br />
</div></div>

<h1><a id="id385" name="id385">GetGlobal</a>
</h1><div class="para"><div>
iTJSDispatch2 * tTJS::GetGlobal()<br />
<br />
　<a id="id386" name="id386" class="targanchor"><dfn>global オブジェクト</dfn></a>を取得します。<a target="main" class="jump" href="interface.html">iTJSDispatch2 API接口</a> 型のオブジェクトが返されます。<br />
　このメソッドは global オブジェクトを返すとき、その参照カウンタをインクリメントします。<br />
</div></div>



<h1><a id="id387" name="id387">GetGlobalNoAddRef</a>
</h1><div class="para"><div>
iTJSDispatch2 * tTJS::GetGlobalNoAddRef()<br />
<br />
　global オブジェクトを取得します。GetGlobal と違うのは、global オブジェクトの参照カウンタをインクリメントしないと言うことです。<br />
</div></div>



<h1><a id="id388" name="id388">SetConsoleOutput</a>
</h1><div class="para"><div>
void tTJS::SetConsoleOutput(iTJSConsoleOutput *console);<br />
<br />
　<a id="id389" name="id389" class="targanchor"><dfn>コンソール</dfn></a>の出力先を指定します。<br />
　コンソールは、TJS2 の出すエラーメッセージなどが出力されるところです。<br />
<br />
以下の引数があります。<br />
<br />
<dl>
<dt>console</dt>
<dd>　コンソールの出力先を定義する、<a id="id390" name="id390" class="targanchor"><dfn>iTJSConsoleOutput</dfn></a> 型のオブジェクトを指定します。<br />
　iTJSConsoleOutput 型は tjs.h に定義されている基本抽象クラスで、以下のメソッドがあります。<br />
<br />
<dl>
<dt>void iTJSConsoleOutput::<a id="id391" name="id391" class="targanchor"><dfn>ExceptionPrint</dfn></a>(const tjs_char *msg)</dt>
<dd>　例外に関する情報を出力するためのメソッドです。msg がメッセージを表します。</dd>
<dt>void iTJSConsoleOutput::<a id="id392" name="id392" class="targanchor"><dfn>Print</dfn></a>(const tjs_char *msg)</dt>
<dd>　その他の情報を出力するためのメソッドです。msg がメッセージを表します。</dd></dl></dd></dl>
</div></div>

<h1><a id="id393" name="id393">GetConsoleOutput</a>
</h1><div class="para"><div>
tTJSConsoleOutput * tTJS::GetConsoleOutput() const<br />
<br />
　コンソールの出力先を取得します。<br />
</div></div>

<h1><a id="id394" name="id394">OutputToConsole</a>
</h1><div class="para"><div>
void tTJS::OutputToConsole(const tjs_char *msg) const<br />
<br />
　コンソールに文字列を出力します。msg は出力するメッセージです。<br />
</div></div>


<h1><a id="id395" name="id395">OutpuExceptionToConsole</a>
</h1><div class="para"><div>
void tTJS::OutpuExceptionToConsole(const tjs_char *msg) const<br />
<br />
　コンソールに例外の文字列を出力します。msg は出力するメッセージです。<br />
</div></div>



<h1><a id="id396" name="id396">OutputToConsoleWithCentering</a>
</h1><div class="para"><div>
void tTJS::OutputToConsoleWithCentering(const tjs_char *msg, tjs_uint width) const<br />
<br />
　コンソールに文字列をセンタリングして出力します。msg は出力するメッセージで、width は横幅です。<br />
　横幅よりも出力するメッセージの文字数が少ない場合は、指定した横幅の中央にセンタリングして出力します
 ( ただしすべての文字の幅を同一であると見なすため、全角が混じると崩れた表示になります )</div></div>





<h1><a id="id397" name="id397">OutputToConsoleSeparator</a>
</h1><div class="para"><div>
void tTJS::OutputToConsoleSeparator(const tjs_char *text, tjs_uint count) const<br />
<br />
　text で示された区切り記号を、count 個、コンソールに出力します。</div></div>




<h1><a id="id398" name="id398">Dump</a>
</h1><div class="para"><div>
void tTJS::Dump(tjs_uint width = 80) const<br />
<br />
　TJS2 の状態をコンソールに出力します。<br />
　各スクリプトブロック中の仮想マシンコードの逆アセンブル結果などが表示されます。<br />
　width には出力する横幅を指定します。</div></div>


<h1><a id="id399" name="id399">ExecScript</a>
</h1><div class="para"><div>
void tTJS::ExecScript(<br />
&nbsp;&nbsp;&nbsp;&nbsp;const tjs_char *script,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tTJSVariant *result = NULL,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 *context = NULL,<br />
&nbsp;&nbsp;&nbsp;&nbsp;const tjs_char *name = NULL,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_int lineofs = 0<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
void tTJS::ExecScript(<br />
&nbsp;&nbsp;&nbsp;&nbsp;const ttstr &amp;script,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tTJSVariant *result = NULL,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 *context = NULL,<br />
&nbsp;&nbsp;&nbsp;&nbsp;const tjs_char *name = NULL,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_int lineofs = 0<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
　スクリプトを実行します。<br />
<br />
　以下の引数があります。<br />
<br />
<dl>
<dt>const tjs_char *script</dt>

<dt>const ttstr &amp;script</dt>
<dd>　実行するスクリプトを指定します。</dd>


<dt>tTJSVariant *result</dt>
<dd>　結果を受け取るための tTJSVariant 型の変数へのポインタを指定します。<br />
　NULL も指定できますが、NULL の場合は結果を受け取ることができません。</dd>
<dt>iTJSDispatch2 *context</dt>
<dd>　このスクリプトが実行されるコンテキストを指定します。<br />
　NULL を指定すると、スクリプトは global コンテキスト上で実行されます。<br />
　通常は NULL を指定しますが、スクリプトを特定のコンテキストで実行したい場合はそのコンテキストとなるオブジェクトを指定してください。</dd>


<dt>const tjs_char *name</dt>
<dd>　スクリプトの名前を指定します。通常、そのスクリプトのファイル名を指定します。<br />
　例外の通知の際にどこのスクリプトで例外が起こったかを知らせたりする目的で使用されます。</dd>

<dt>tjs_int lineofs</dt>
<dd>　スクリプト中の、そのスクリプトの始まった行(0～)を指定します。<br />
　KAGシナリオ中に埋め込まれたTJSスクリプトのように、他のドキュメント中にTJSスクリプトが埋め込まれる場合に、そのTJSスクリプトの開始行を指定します。<br />
　例外の通知の際にどこのスクリプトで例外が起こったかを知らせたりする目的で使用されます。</dd>


</dl></div></div>

<h1><a id="id400" name="id400">EvalExpression</a>
</h1><div class="para"><div>
void tTJS::EvalExpression(<br />
&nbsp;&nbsp;&nbsp;&nbsp;const tjs_char *expression,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tTJSVariant *result = NULL,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 *context = NULL,<br />
&nbsp;&nbsp;&nbsp;&nbsp;const tjs_char *name = NULL<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_int lineofs = 0<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
void tTJS::EvalExpression(<br />
&nbsp;&nbsp;&nbsp;&nbsp;const ttstr &amp;expression,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tTJSVariant *result = NULL,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 *context = NULL,<br />
&nbsp;&nbsp;&nbsp;&nbsp;const tjs_char *name = NULL<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_int lineofs = 0<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
　式を評価します。<br />
　引数については ExecScript を参照してください。<br />
<br />
　<a id="id401" name="id401" class="targanchor"><dfn>if 演算子</dfn></a>のように式の結果を得ることができない演算子の場合、その結果を得ようとして result に非 NULL を指定すると例外が発生します。この場合は result には NULL を指定する必要があります。</div></div>




<h1><a id="id402" name="id402">SetPPValue</a>
</h1><div class="para"><div>
void tTJS::SetPPValue(const tjs_char *name, const tjs_int32 value)<br />
<br />
　<a id="id403" name="id403" class="targanchor"><dfn>条件コンパイル</dfn></a>用の変数を設定します。name は変数の名前、value は設定する値です。<br />
</div></div>



<h1><a id="id404" name="id404">GetPPValue</a>
</h1><div class="para"><div>
tjs_int32 tTJS::GetPPValue(const tjs_char *name)<br />
<br />
　条件コンパイル用の変数を取得します。name は変数の名前です。変数が見つからなかった場合は 0 が帰ります。<br />
</div></div>




<h1><a id="id405" name="id405">DoGarbageCollection</a>
</h1><div class="para"><div>
tjs_int32 tTJS::DoGarbageCollection()<br />
<br />
　<a id="id406" name="id406" class="targanchor"><dfn>ガベージコレクション</dfn></a>を行います。TJS2 が保持しているキャッシュをクリアしたり、未処理のクリーンアップ処理を完了させます。<br />
</div></div>
	<script type="text/javascript" charset="UTF-8" src="documentid.js" ></script>
	<script type="text/javascript" charset="UTF-8" src="postcontent.js" ></script>
</body>
</html>
